#!/usr/bin/perl -w

use strict;

if ($ARGV[0] eq "-list") {
	my @list = list_names($ARGV[1]);
	printf("@list");
} elsif ($ARGV[0] eq "-reduced") {
	my $destination = $ARGV[1];
	install_reduced($destination);
} else {
	my $destination = $ARGV[0];
	install_reduced($destination);
}

sub install_reduced {
	my ($corpusdir) = @_;
	my $src = "jboss-5.1.0.GA-src.tar.gz";
	my $bin = "jboss-5.1.0.GA.zip";
	my @files = ("jboss-5.1.0.GA/common/lib/jbossjts-jacorb.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jstl.jar","jboss-5.1.0.GA/client/jaxws-rt.jar","jboss-5.1.0.GA/client/jbosssx-client.jar","jboss-5.1.0.GA/client/jbossws-framework.jar","jboss-5.1.0.GA/client/jbossjts-integration.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jsf-libs/jsf-impl.jar","jboss-5.1.0.GA/client/concurrent.jar","jboss-5.1.0.GA/lib/jboss-classloading-vfs.jar","jboss-5.1.0.GA/common/lib/jboss-jmx-remoting.jar","jboss-5.1.0.GA/lib/jboss-managed.jar","jboss-5.1.0.GA/client/jboss-jsr77-client.jar","jboss-5.1.0.GA/client/jmx-client.jar","jboss-5.1.0.GA/client/antlr.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-common.jar","jboss-5.1.0.GA/client/jboss-aspect-jdk50-client.jar","jboss-5.1.0.GA/lib/jboss-metatype.jar","jboss-5.1.0.GA/common/lib/hsqldb-plugin.jar","jboss-5.1.0.GA/lib/endorsed/resolver.jar","jboss-5.1.0.GA/server/all/deploy/management/console-mgr.sar/jcommon.jar","jboss-5.1.0.GA/server/all/deploy/management/console-mgr.sar/console-mgr-classes.jar","jboss-5.1.0.GA/server/minimal/lib/jboss-minimal.jar","jboss-5.1.0.GA/docs/examples/jmx/ejb-management.jar","jboss-5.1.0.GA/client/jbosssx-as-client.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jsf-libs/jsf-api.jar","jboss-5.1.0.GA/common/lib/jbossts-common.jar","jboss-5.1.0.GA/common/lib/scheduler-plugin.jar","jboss-5.1.0.GA/client/jnp-client.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-timerservice-spi.jar","jboss-5.1.0.GA/client/jboss-ha-legacy-client.jar","jboss-5.1.0.GA/common/lib/hibernate-entitymanager.jar","jboss-5.1.0.GA/common/lib/hibernate-validator.jar","jboss-5.1.0.GA/client/jboss-system-jmx-client.jar","jboss-5.1.0.GA/client/jboss-client.jar","jboss-5.1.0.GA/client/jbossws-spi.jar","jboss-5.1.0.GA/client/policy.jar","jboss-5.1.0.GA/client/jboss-integration.jar","jboss-5.1.0.GA/client/jboss-j2se.jar","jboss-5.1.0.GA/client/stax-ex.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/richfaces-ui-3.3.0.GA.jar","jboss-5.1.0.GA/client/xmlsec.jar","jboss-5.1.0.GA/common/lib/jboss-ha-server-api.jar","jboss-5.1.0.GA/common/lib/jnpserver.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-interceptors.jar","jboss-5.1.0.GA/common/lib/commons-collections.jar","jboss-5.1.0.GA/common/lib/jbosssx.jar","jboss-5.1.0.GA/client/jboss-jaspi-api.jar","jboss-5.1.0.GA/client/jboss-iiop-client.jar","jboss-5.1.0.GA/client/jboss-ejb3-ext-api-impl.jar","jboss-5.1.0.GA/server/all/deployers/seam.deployer/lib-int/jboss-seam-int-jbossas.jar","jboss-5.1.0.GA/lib/jboss-classloader.jar","jboss-5.1.0.GA/lib/jboss-aop-jboss5.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jbossweb.jar","jboss-5.1.0.GA/client/jbossws-native-jaxrpc.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-proxy-clustered.jar","jboss-5.1.0.GA/client/FastInfoset.jar","jboss-5.1.0.GA/client/jacorb.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/plugins/jopr-jboss-as-5-plugin-2.3.0.EmbJopr.1.2.0-1.jar","jboss-5.1.0.GA/client/wsdl4j.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/webbeans-logging.jar","jboss-5.1.0.GA/common/lib/properties-plugin.jar","jboss-5.1.0.GA/common/lib/bsh.jar","jboss-5.1.0.GA/client/jbossjts.jar","jboss-5.1.0.GA/client/jaxb-xjc.jar","jboss-5.1.0.GA/client/jboss-metadata.jar","jboss-5.1.0.GA/lib/jboss-aop-mc-int.jar","jboss-5.1.0.GA/lib/jboss-deployers-spi.jar","jboss-5.1.0.GA/client/jmx-invoker-adaptor-client.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-transactions.jar","jboss-5.1.0.GA/lib/jboss-reflect.jar","jboss-5.1.0.GA/client/jboss-serialization.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/i18nlog-1.0.9.jar","jboss-5.1.0.GA/client/jboss-deployers-vfs-spi.jar","jboss-5.1.0.GA/server/all/deploy/jmx-remoting.sar/jbossas-jmx-remoting.jar","jboss-5.1.0.GA/lib/jboss-classloading.jar","jboss-5.1.0.GA/server/all/deployers/jbossws.deployer/jboss-jaxb-intros.jar","jboss-5.1.0.GA/server/all/deployers/jboss-ejb3-endpoint-deployer.jar","jboss-5.1.0.GA/lib/endorsed/serializer.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/plugins/rhq-platform-plugin-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/server/all/deploy/juddi-service.sar/juddi.jar","jboss-5.1.0.GA/client/jettison.jar","jboss-5.1.0.GA/common/lib/autonumber-plugin.jar","jboss-5.1.0.GA/client/jboss-deployers-core.jar","jboss-5.1.0.GA/client/jboss-remoting.jar","jboss-5.1.0.GA/client/javassist.jar","jboss-5.1.0.GA/server/all/lib/jgroups.jar","jboss-5.1.0.GA/common/lib/jboss-ha-server-cache-jbc.jar","jboss-5.1.0.GA/server/all/deployers/jboss-aop-jboss5.deployer/jboss-aop-aspects.jar","jboss-5.1.0.GA/common/lib/jboss-jca.jar","jboss-5.1.0.GA/client/jboss-ejb3-common-client.jar","jboss-5.1.0.GA/server/all/deploy/xnio-provider.jar/xnio-nio.jar","jboss-5.1.0.GA/server/all/deployers/bsh.deployer/bsh-deployer.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/webbeans-jboss-int-jboss-ejb.jar","jboss-5.1.0.GA/server/all/lib/jbosscache-core.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-core.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-security.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jasper-jdt.jar","jboss-5.1.0.GA/client/jboss-deployers-vfs.jar","jboss-5.1.0.GA/common/lib/jbosssx-server.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/jsr299-api.jar","jboss-5.1.0.GA/client/jboss-logging-log4j.jar","jboss-5.1.0.GA/client/getopt.jar","jboss-5.1.0.GA/client/jboss-messaging-client.jar","jboss-5.1.0.GA/client/jboss-deployers-client.jar","jboss-5.1.0.GA/common/lib/log4j-snmp-appender.jar","jboss-5.1.0.GA/server/all/deploy/management/console-mgr.sar/web-console.war/applet.jar","jboss-5.1.0.GA/common/lib/hsqldb.jar","jboss-5.1.0.GA/lib/jboss-jmx.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jboss-seam-jul-2.1.0.SP1.jar","jboss-5.1.0.GA/common/lib/jboss-threads.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jsf-libs/jboss-faces.jar","jboss-5.1.0.GA/common/lib/jsp-api.jar","jboss-5.1.0.GA/docs/examples/jmx/logging-monitor/lib/logging-monitor.jar","jboss-5.1.0.GA/common/lib/jboss-current-invocation-aspects.jar","jboss-5.1.0.GA/common/lib/el-api.jar","jboss-5.1.0.GA/common/lib/jaxen.jar","jboss-5.1.0.GA/server/all/deployers/ejb3.deployer/jboss-ejb3-iiop.jar","jboss-5.1.0.GA/client/mail.jar","jboss-5.1.0.GA/lib/endorsed/xercesImpl.jar","jboss-5.1.0.GA/client/jaxb-api.jar","jboss-5.1.0.GA/common/lib/jboss-monitoring.jar","jboss-5.1.0.GA/client/slf4j-jboss-logging.jar","jboss-5.1.0.GA/lib/dom4j.jar","jboss-5.1.0.GA/common/lib/bcel.jar","jboss-5.1.0.GA/server/all/deploy/juddi-service.sar/juddi-saaj.jar","jboss-5.1.0.GA/client/jbossws-native-core.jar","jboss-5.1.0.GA/common/lib/hibernate-jmx.jar","jboss-5.1.0.GA/client/jboss-ejb3-proxy-spi-client.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-native-system-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/lib/jboss-profileservice-spi.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-plugin-container-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/client/scout.jar","jboss-5.1.0.GA/client/jboss-common-core.jar","jboss-5.1.0.GA/common/lib/jboss-hibernate.jar","jboss-5.1.0.GA/client/jboss-ejb3-ext-api.jar","jboss-5.1.0.GA/common/lib/servlet-api.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/richfaces-api-3.3.0.GA.jar","jboss-5.1.0.GA/lib/jboss-deployers-impl.jar","jboss-5.1.0.GA/server/all/deployers/seam.deployer/jboss-seam-int-microcontainer.jar","jboss-5.1.0.GA/client/slf4j-api.jar","jboss-5.1.0.GA/common/lib/hibernate-commons-annotations.jar","jboss-5.1.0.GA/common/lib/jbossha.jar","jboss-5.1.0.GA/common/lib/jboss-management.jar","jboss-5.1.0.GA/common/lib/jboss-iiop.jar","jboss-5.1.0.GA/common/lib/joesnmp.jar","jboss-5.1.0.GA/lib/jboss-aop-deployers.jar","jboss-5.1.0.GA/client/jboss-deployment.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-mc-int.jar","jboss-5.1.0.GA/client/wstx.jar","jboss-5.1.0.GA/client/hibernate-annotations.jar","jboss-5.1.0.GA/client/jboss-logging-spi.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-client-api-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jboss-seam-ui-2.1.0.SP1.jar","jboss-5.1.0.GA/client/jboss-system-client.jar","jboss-5.1.0.GA/common/lib/hibernate-core.jar","jboss-5.1.0.GA/lib/jboss-aop.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/webbeans-jboss-int-deployer.jar","jboss-5.1.0.GA/common/lib/jboss-srp.jar","jboss-5.1.0.GA/lib/jboss-aop-asintegration-jmx.jar","jboss-5.1.0.GA/server/all/deployers/jboss-threads.deployer/jboss-threads-metadata.jar","jboss-5.1.0.GA/lib/jboss-kernel.jar","jboss-5.1.0.GA/client/avalon-framework.jar","jboss-5.1.0.GA/client/jboss-srp-client.jar","jboss-5.1.0.GA/lib/jboss-vfs.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-endpoint.jar","jboss-5.1.0.GA/client/jbossjmx-ant.jar","jboss-5.1.0.GA/common/lib/xnio-api.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-proxy-spi.jar","jboss-5.1.0.GA/common/lib/mail-plugin.jar","jboss-5.1.0.GA/server/all/conf/bindingservice.beans/jboss-bindingservice.jar","jboss-5.1.0.GA/server/all/deploy/juddi-service.sar/juddi-service.jar","jboss-5.1.0.GA/server/all/deployers/jbossweb.deployer/jboss-web-deployer.jar","jboss-5.1.0.GA/client/jbossws-native-jaxws-ext.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jsf-facelets-1.1.15.B1.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-comm-api-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/common/lib/jbossxacml.jar","jboss-5.1.0.GA/client/jboss-aop-client.jar","jboss-5.1.0.GA/server/all/deployers/xnio.deployer/xnio-metadata.jar","jboss-5.1.0.GA/common/lib/jboss-remoting-aspects.jar","jboss-5.1.0.GA/common/lib/jbossas-remoting.jar","jboss-5.1.0.GA/lib/jboss-logmanager.jar","jboss-5.1.0.GA/server/all/deployers/ejb3.deployer/jboss-ejb3-deployer.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-metadata.jar","jboss-5.1.0.GA/client/jboss-ejb3-core-client.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/webbeans-api.jar","jboss-5.1.0.GA/lib/jboss-aop-asintegration-mc.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/lib-int/webbeans-core.jar","jboss-5.1.0.GA/common/lib/jboss-transaction-aspects.jar","jboss-5.1.0.GA/client/jbossws-native-jaxws.jar","jboss-5.1.0.GA/client/jboss-deployers-client-spi.jar","jboss-5.1.0.GA/server/all/deployers/jboss-aop-jboss5.deployer/jrockit-pluggable-instrumentor.jar","jboss-5.1.0.GA/server/all/deploy/snmp-adaptor.sar/snmp-adaptor.jar","jboss-5.1.0.GA/lib/endorsed/xalan.jar","jboss-5.1.0.GA/lib/jboss-logbridge.jar","jboss-5.1.0.GA/client/activation.jar","jboss-5.1.0.GA/common/lib/jboss-negotiation.jar","jboss-5.1.0.GA/docs/examples/varia/derby-plugin.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-deployers.jar","jboss-5.1.0.GA/lib/jboss-deployers-structure-spi.jar","jboss-5.1.0.GA/client/streambuffer.jar","jboss-5.1.0.GA/server/all/deployers/jboss-aop-jboss5.deployer/jboss-aspect-library.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/commons-beanutils-1.7.0.jar","jboss-5.1.0.GA/server/all/deploy/management/console-mgr.sar/web-console.war/images/otherimages.jar","jboss-5.1.0.GA/client/jbossws-jboss50.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/commons-collections-3.2.jar","jboss-5.1.0.GA/client/jbossws-native-client.jar","jboss-5.1.0.GA/common/lib/jboss-jpa-deployers.jar","jboss-5.1.0.GA/server/all/deploy/management/console-mgr.sar/jfreechart.jar","jboss-5.1.0.GA/client/jboss-mdr.jar","jboss-5.1.0.GA/client/jbossws-native-saaj.jar","jboss-5.1.0.GA/client/jboss-ejb3-security-client.jar","jboss-5.1.0.GA/server/all/lib/hibernate-jbosscache2.jar","jboss-5.1.0.GA/common/lib/jboss.jar","jboss-5.1.0.GA/common/lib/dtdparser121.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jboss-seam-debug-2.1.0.SP1.jar","jboss-5.1.0.GA/client/jbosscx-client.jar","jboss-5.1.0.GA/common/lib/jboss-messaging.jar","jboss-5.1.0.GA/lib/jboss-classloading-spi.jar","jboss-5.1.0.GA/lib/jboss-mbeans.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jdom-1.0.jar","jboss-5.1.0.GA/common/lib/jboss-ha-server-cache-spi.jar","jboss-5.1.0.GA/common/lib/jboss-profileservice.jar","jboss-5.1.0.GA/lib/jboss-aop-asintegration-core.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-proxy-impl.jar","jboss-5.1.0.GA/common/lib/jboss-jsr77.jar","jboss-5.1.0.GA/client/stax-api.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-util-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/server/all/lib/jbosscache-pojo.jar","jboss-5.1.0.GA/server/all/deployers/jboss-jca.deployer/jboss-jca-deployer.jar","jboss-5.1.0.GA/common/lib/bsf.jar","jboss-5.1.0.GA/client/trove.jar","jboss-5.1.0.GA/common/lib/jboss-security-aspects.jar","jboss-5.1.0.GA/lib/log4j-boot.jar","jboss-5.1.0.GA/lib/jboss-system.jar","jboss-5.1.0.GA/lib/osgi.core.jar","jboss-5.1.0.GA/client/jaxws-tools.jar","jboss-5.1.0.GA/common/lib/jboss-messaging-int.jar","jboss-5.1.0.GA/common/lib/jboss-jsr88.jar","jboss-5.1.0.GA/common/lib/jboss-ejb3-cache.jar","jboss-5.1.0.GA/client/log4j.jar","jboss-5.1.0.GA/server/all/deployers/webbeans.deployer/webbeans-spi.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-gui-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/client/ejb3-persistence.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/richfaces-impl-3.3.0.GA.jar","jboss-5.1.0.GA/server/all/deploy/jbossweb.sar/jboss-web-service.jar","jboss-5.1.0.GA/client/jbossws-common.jar","jboss-5.1.0.GA/server/all/lib/jcip-annotations.jar","jboss-5.1.0.GA/client/commons-logging.jar","jboss-5.1.0.GA/client/jboss-javaee.jar","jboss-5.1.0.GA/client/jboss-ejb3-proxy-clustered-client.jar","jboss-5.1.0.GA/client/jboss-ejb3-proxy-impl-client.jar","jboss-5.1.0.GA/common/lib/jboss-common-jdbc-wrapper.jar","jboss-5.1.0.GA/client/jboss-xml-binding.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-domain-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/common/lib/scheduler-plugin-example.jar","jboss-5.1.0.GA/client/jaxb-impl.jar","jboss-5.1.0.GA/server/all/deployers/jboss-aop-jboss5.deployer/pluggable-instrumentor.jar","jboss-5.1.0.GA/lib/jboss-dependency.jar","jboss-5.1.0.GA/bin/shutdown.jar","jboss-5.1.0.GA/lib/jboss-main.jar","jboss-5.1.0.GA/lib/jboss-bootstrap.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/org.jboss.seam-jboss-seam-2.1.0.SP1.jar","jboss-5.1.0.GA/client/jboss-main-client.jar","jboss-5.1.0.GA/common/lib/jmx-adaptor-plugin.jar","jboss-5.1.0.GA/client/jbossall-client.jar","jboss-5.1.0.GA/client/jboss-appclient.jar","jboss-5.1.0.GA/bin/twiddle.jar","jboss-5.1.0.GA/client/jboss-logging-jdk.jar","jboss-5.1.0.GA/lib/jboss-system-jmx.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/rhq-core-plugin-api-1.3.0.EmbJopr.1_2_0-1.jar","jboss-5.1.0.GA/client/jboss-security-spi.jar","jboss-5.1.0.GA/bin/run.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/commons-digester-1.8.jar","jboss-5.1.0.GA/common/lib/quartz.jar","jboss-5.1.0.GA/client/jboss-ha-client.jar","jboss-5.1.0.GA/server/all/deploy/admin-console.war/WEB-INF/lib/jboss-el-1.0_02.CR2.jar","jboss-5.1.0.GA/client/jboss-deployers-core-spi.jar","jboss-5.1.0.GA/client/logkit.jar");
	printf("\t\t unpacking $src\n");
	system("tar zxf $corpusdir/compressed/$src -C $corpusdir/src\n") == 0 or die "Failed to extract $src\n";
	printf("\t\t unpacking $bin\n");
	system("unzip -qo $corpusdir/compressed/$bin @files -d $corpusdir/bin\n") == 0 or die "Failed to extract $bin\n";
}

sub list_names {
	my ($appverdir) = @_;
	opendir(COMPRESSED, "$appverdir/compressed") || die "can't open $appverdir/compressed: $!";
	my @archives = grep {! /^\.$/ and ! /^\.\.$/ } readdir(COMPRESSED);
	close(COMPRESSED);
	return @archives;
}
