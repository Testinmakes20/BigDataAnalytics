<!DOCTYPE html>
<html>
<head>
    <title>Clone Detector Statistics</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            max-width: 900px;
            margin: 30px auto;
            display: block;
        }
    </style>
</head>
<body>

<h2 align="center">Clone Detector Monitoring</h2>

<canvas id="filesChart"></canvas>
<canvas id="chunksChart"></canvas>
<canvas id="candidatesChart"></canvas>
<canvas id="clonesChart"></canvas>

<script>
fetch("/data")
  .then(res => res.json())
  .then(data => {
    const labels = data.timestamps.map(t =>
      new Date(t).toLocaleTimeString()
    );

    function createChart(canvasId, label, values) {
      new Chart(document.getElementById(canvasId), {
        type: "line",
        data: {
          labels: labels,
          datasets: [{
            label: label,
            data: values,
            borderWidth: 2,
            fill: false
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    createChart("filesChart", "Files Processed", data.files);
    createChart("chunksChart", "Chunks Generated", data.chunks);
    createChart("candidatesChart", "Clone Candidates", data.candidates);
    createChart("clonesChart", "Confirmed Clones", data.clones);
  });
</script>

</body>
</html>
